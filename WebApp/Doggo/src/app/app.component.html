<div class="container" style="margin: 30px auto; max-width: 1200px; background: linear-gradient(135deg, #232526 0%, #414345 100%); border-radius: 16px; box-shadow: 0 2px 24px rgba(0,0,0,0.18); padding: 36px 26px;">
  <div style="display: flex; flex-wrap: wrap; align-items: flex-start; width: 100%; gap: 32px;">
    <!-- Linke Spalte: Map und Auswahlleiste -->
    <div style="display: flex; flex-direction: column; flex: 1 1 650px; min-width: 400px; max-width: 750px; background: #f5f7fa; border-radius: 10px; box-shadow: 0 1px 8px rgba(0,0,0,0.06); padding: 24px 18px;">
      <google-map [height]="500" width="100%" [center]="center" [zoom]="zoom" style="border-radius: 8px; box-shadow: 0 1px 6px rgba(0,0,0,0.07);" #map (mapClick)="onMapClick($event)">
        <!-- Benutzer-Standort -->
        <map-marker *ngIf="userLocationMarker"
          [position]="userLocationMarker.position!"
          [title]="userLocationMarker.title || ''"
          [icon]="userLocationMarker.icon ? userLocationMarker.icon : ''">
        </map-marker>
        
        <!-- Hundeparks -->
        <map-marker *ngFor="let marker of filteredDogParkMarkers; let i = index"
          [position]="marker.position!"
          [title]="marker.title || ''"
          [icon]="marker.icon ? marker.icon : ''"
          (mapClick)="openDogParkInfo(i, $event)"
          #parkMarker>
        </map-marker>
        
        <!-- Hundesackerlspender -->
        <map-marker *ngFor="let marker of filteredWasteDispenserMarkers; let i = index"
          [position]="marker.position!"
          [title]="marker.title || ''"
          [icon]="marker.icon ? marker.icon : ''"
          (mapClick)="openWasteDispenserInfo(i, $event)"
          #dispenserMarker>
        </map-marker>
        
        <!-- Info Window -->
        <map-info-window #infoWindow [position]="infoWindowPosition || center">
          <div [innerHTML]="infoWindowContent"></div>
        </map-info-window>
      </google-map>
      <!-- Auswahlleiste standalone, unter der Map, volle Breite der Spalte -->
      <div class="selection" style="margin-top: 18px; width: 100%; min-height: 75px; background: linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%); border-radius: 10px; padding: 16px; display: flex; flex-wrap: wrap; align-items: center; gap: 12px; box-shadow: 0 2px 8px rgba(80,120,200,0.08); border: 1.5px solid #b6c6e3; overflow: visible;">
        
        <!-- Toggle für registrierte Nutzer -->
        <div *ngIf="currentUser" style="display: flex; align-items: center; flex-shrink: 0;">
          <button 
            (click)="toggleInfoMode()"
            [style.background]="!showMyDogs ? 'linear-gradient(135deg, #667eea 0%, #764ba2 100%)' : 'linear-gradient(135deg, #f093fb 0%, #f5576c 100%)'"
            style="color: white; border: none; border-radius: 8px; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2); white-space: nowrap;"
            [title]="showMyDogs ? 'Zu allgemeinen Infos wechseln' : 'Meine Hunde anzeigen'">
            {{ showMyDogs ? '📋 Infos' : '🐾 Meine' }}
          </button>
        </div>

        <!-- Auswahl für allgemeine Kategorien -->
        <div *ngIf="!showMyDogs" style="display: flex; align-items: center; gap: 8px; flex: 1; min-width: 200px; max-width: 100%;">
          <span style="font-weight: 600; color: #2c3e50; font-size: 0.9rem; flex-shrink: 0;">🐾 Kategorie:</span>
          <select id="categorySelect" [(ngModel)]="selectedDogCategory" style="flex: 1; min-width: 120px; padding: 6px 10px; border-radius: 6px; border: 1.5px solid #a3b8d8; background: #fafdff; font-size: 0.85rem; font-weight: 500; color: #2c3e50; box-shadow: 0 1px 4px rgba(80,120,200,0.06); transition: border 0.2s; outline: none;">
            <option [ngValue]="null" style="color:#6c757d; font-style:italic; background:#f0f4fa;">🌐 Allgemeine Hinweise</option>
            <option *ngFor="let category of dogCategories; let i = index" [ngValue]="category" [ngStyle]="{
              'background': i % 2 === 0 ? '#e0eafc' : '#cfdef3',
              'color': '#2c3e50',
              'font-weight': 500,
              'border-radius': '6px',
              'padding': '4px 0'
            }">🐕 {{ category.name }}</option>
          </select>
        </div>

        <!-- Auswahl für eigene Hunde -->
        <div *ngIf="showMyDogs && currentUser" style="display: flex; align-items: center; gap: 8px; flex: 1; min-width: 200px; max-width: 100%;">
          <span style="font-weight: 600; color: #2c3e50; font-size: 0.9rem; flex-shrink: 0;">🐕 Hund:</span>
          <select *ngIf="myDogs.length > 0" [(ngModel)]="selectedDog" style="flex: 1; min-width: 120px; padding: 6px 10px; border-radius: 6px; border: 1.5px solid #a3b8d8; background: #fafdff; font-size: 0.85rem; font-weight: 500; color: #2c3e50; box-shadow: 0 1px 4px rgba(80,120,200,0.06); transition: border 0.2s; outline: none;">
            <option *ngFor="let dog of myDogs" [ngValue]="dog">🐾 {{ dog.name }} ({{ dog.breed }})</option>
          </select>
          <span *ngIf="myDogs.length === 0" style="flex: 1; min-width: 120px; padding: 6px 10px; border-radius: 6px; background: #f8f9fa; color: #6c757d; font-style: italic; border: 1.5px solid #dee2e6; font-size: 0.8rem; text-align: center;">Keine Hunde registriert</span>
        </div>
      </div>
      
      <!-- Filter-Controls für Kartenmarker -->
      <div class="map-filters" style="margin-top: 16px; width: 100%; background: linear-gradient(90deg, #f8ffae 0%, #43c6ac 100%); border-radius: 10px; padding: 14px; display: flex; flex-wrap: wrap; align-items: center; gap: 12px; box-shadow: 0 2px 8px rgba(80,120,200,0.08); border: 1.5px solid #7dd3c0; overflow: visible;">
        <span style="font-weight: 600; color: #2c3e50; font-size: 0.95rem; flex-shrink: 0;">🗺️ Filter:</span>
        
        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; background: rgba(255,255,255,0.8); padding: 6px 10px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: all 0.2s; flex-shrink: 0;">
          <input type="checkbox" [(ngModel)]="showDogParks" style="transform: scale(1.1);">
          <span style="width: 10px; height: 10px; background-color: #28a745; border-radius: 50%; display: inline-block;"></span>
          <span style="color: #2c3e50; font-weight: 500; font-size: 0.85rem;">🏞️ Parks</span>
        </label>
        
        <label style="display: flex; align-items: center; gap: 6px; cursor: pointer; background: rgba(255,255,255,0.8); padding: 6px 10px; border-radius: 6px; box-shadow: 0 1px 3px rgba(0,0,0,0.1); transition: all 0.2s; flex-shrink: 0;">
          <input type="checkbox" [(ngModel)]="showWasteDispensers" style="transform: scale(1.1);">
          <div style="display: flex; align-items: center; gap: 2px;">
            <span style="width: 8px; height: 8px; background-color: #ffc107; border-radius: 50%; display: inline-block;"></span>
            <span style="width: 8px; height: 8px; background-color: #dc3545; border-radius: 50%; display: inline-block;"></span>
          </div>
          <span style="color: #2c3e50; font-weight: 500; font-size: 0.85rem;">🗑️ Spender</span>
        </label>
        
        <!-- Bearbeitungsmodus-Toggle für angemeldete Nutzer -->
        <button *ngIf="currentUser" 
                (click)="toggleEditMode()"
                [style.background]="editMode ? 'linear-gradient(135deg, #ff6b6b 0%, #ee5a24 100%)' : 'linear-gradient(135deg, #74b9ff 0%, #0984e3 100%)'"
                style="color: white; border: none; border-radius: 6px; padding: 6px 12px; cursor: pointer; font-weight: 600; font-size: 0.85rem; transition: all 0.3s ease; box-shadow: 0 2px 8px rgba(0,0,0,0.2); flex-shrink: 0;"
                [title]="editMode ? 'Bearbeitungsmodus deaktivieren - Klick zeigt wieder Infos' : 'Bearbeitungsmodus aktivieren - Klick öffnet Status-Editor'">
          {{ editMode ? '✏️ Bearbeiten AN' : '👁️ Info-Modus' }}
        </button>
        
        <!-- Legende für Spender-Farben -->
        <div style="font-size: 0.75rem; color: #555; display: flex; gap: 8px; margin-left: auto; flex-shrink: 0;">
          <span style="display: flex; align-items: center; gap: 3px;">
            <span style="width: 6px; height: 6px; background-color: #ffc107; border-radius: 50%; display: inline-block;"></span>
            OK
          </span>
          <span style="display: flex; align-items: center; gap: 3px;">
            <span style="width: 6px; height: 6px; background-color: #dc3545; border-radius: 50%; display: inline-block;"></span>
            Defekt
          </span>
        </div>
      </div>
      <!-- Wetteranzeige: Simple, modern, unter der Auswahlleiste -->
      <div *ngIf="weather" class="weather-glass-box animate-fadein" [ngClass]="{ 'weather-night': isNight, 'weather-day': !isNight }">
        <span class="weather-emoji" [title]="getWeatherEmojiTitle(weather.main)">
          {{ getWeatherEmoji(weather.main) }}
        </span>
        <div style="display: flex; flex-direction: column;">
          <span class="weather-temp">{{ weather.temp }}°C</span>
          <span class="weather-desc">{{ weather.description }}</span>
          <!-- Wettericon entfernt, da es wie ein Kreis unter 'Klarer Himmel' aussieht -->
        </div>
        <div *ngIf="wind !== null || humidity !== null" style="margin-top: 6px; font-size: 0.98rem; color: #3b6ea5; display: flex; gap: 18px;">
          <span *ngIf="wind !== null" [title]="getWindTitle()">💨 {{ wind }} km/h</span>
          <span *ngIf="humidity !== null" [title]="getHumidityTitle()">💧 {{ humidity }}%</span>
        </div>
        <div *ngIf="sunrise || sunset" style="margin-top: 4px; font-size: 0.95rem; color: #6c757d; display: flex; gap: 14px;">
          <span *ngIf="sunrise" [title]="getSunriseTitle()">🌅 {{ sunrise }}</span>
          <span *ngIf="sunset" [title]="getSunsetTitle()">🌇 {{ sunset }}</span>
        </div>
        <div *ngIf="weatherWarning" style="margin-top: 8px; color: #d32f2f; font-weight: bold; font-size: 1.05rem;">{{ weatherWarning }}</div>
        <div class="weather-gloss"></div>
      </div>
    </div>
    <!-- Informationen rechts -->
    <div class="info-section" style="flex: 2 1 350px; min-width: 260px; max-width: 500px; background: #f8f9fa; border-radius: 10px; box-shadow: 0 1px 8px rgba(0,0,0,0.06); padding: 28px 22px;">
      <h3 style="margin-bottom: 14px; color: #232526; font-weight: 600; letter-spacing: 0.2px; font-size: 1.08rem; text-shadow: 0 1px 4px #e0eafc;">
        {{ showMyDogs && selectedDog ? selectedDog.name + ' - Mein Hund' : 'Alles Wichtige auf einen Blick' }}
      </h3>

      <!-- Anzeige für eigene Hunde -->
      <div *ngIf="showMyDogs && selectedDog && currentUser">
        <!-- Grund-Informationen -->
        <div style="background: linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 10px 12px 8px 12px; margin-bottom: 10px;">
          <h4 style="margin-top: 0; margin-bottom: 8px; color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.95rem;">🐕 Grund-Informationen</h4>
          <div style="color: #2c3e50; font-size: 0.9rem; display: grid; grid-template-columns: auto 1fr; gap: 6px 10px; margin-bottom: 8px;">
            <strong>Name:</strong> <span>{{ selectedDog.name }}</span>
            <strong>Rasse:</strong> <span>{{ selectedDog.breed }}</span>
            <strong>Alter:</strong> <span>{{ selectedDog.age }} Jahre ({{ getDogAgeCategory(selectedDog) }})</span>
            <strong>Größe:</strong> <span>{{ getDogSizeCategory(selectedDog) }}</span>
            <strong>Letzter Spaziergang:</strong> <span>{{ formatLastWalk(selectedDog) }}</span>
            <div *ngIf="selectedDog.isSpecialBreed" style="grid-column: 1 / -1; background: #ffeaa7; padding: 6px; border-radius: 4px; border-left: 3px solid #fdcb6e; margin-top: 6px; font-size: 0.85rem;">
              <strong>⚠️ Spezielle Rasse:</strong> Besondere Vorschriften beachten!
            </div>
          </div>
        </div>

        <!-- Gesetzliche Anforderungen -->
        <div style="background: linear-gradient(90deg, #f8ffae 0%, #43c6ac 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 10px 12px 8px 12px; margin-bottom: 10px;">
          <h4 style="margin-top: 0; margin-bottom: 8px; color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.95rem;">⚖️ Gesetzliche Anforderungen</h4>
          <ul style="margin-bottom: 8px; color: #2c3e50; font-size: 0.85rem; padding-left: 0; list-style: none;">
            <li *ngFor="let requirement of getDogRequirements(selectedDog)" style="margin-bottom: 4px; padding: 2px 0;">{{ requirement }}</li>
          </ul>
        </div>

        <!-- Pflege & Betreuung -->
        <div style="background: linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 10px 12px 8px 12px;">
          <h4 style="margin-top: 0; margin-bottom: 8px; color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 0.95rem;">🏥 Pflege & Betreuung</h4>
          <ul style="color: #2c3e50; font-size: 0.85rem; padding-left: 0; list-style: none; margin-bottom: 8px;">
            <li *ngFor="let info of getDogCareInfo(selectedDog)" style="margin-bottom: 4px; padding: 2px 0;">{{ info }}</li>
          </ul>
        </div>
      </div>

      <!-- Anzeige bei keinen eigenen Hunden -->
      <div *ngIf="showMyDogs && (!selectedDog || myDogs.length === 0) && currentUser">
        <div style="text-align: center; padding: 32px 16px; color: #6c757d;">
          <div style="font-size: 3rem; margin-bottom: 16px;">🐕</div>
          <h4 style="color: #2c3e50; margin-bottom: 12px;">Keine Hunde registriert</h4>
          <p style="margin-bottom: 16px; font-size: 0.95rem;">Sie haben noch keine Hunde in Ihrem Profil hinterlegt.</p>
          <div style="background: #e3f2fd; border-radius: 8px; padding: 12px; font-size: 0.9rem;">
            <strong>💡 Tipp:</strong> Besuchen Sie die <a routerLink="/profile" style="color: #1976d2; text-decoration: none; font-weight: 600;">Profilverwaltung</a>, um Ihre Hunde zu registrieren.
          </div>
        </div>
      </div>

      <!-- Anzeige für allgemeine Kategorien (Original) -->
      <div *ngIf="!showMyDogs">
        <div *ngIf="selectedDogCategory">
          <div style="background: linear-gradient(90deg, #e0eafc 0%, #cfdef3 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 12px 14px 8px 14px; margin-bottom: 12px;">
            <h4 style="margin-top: 0; color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 1rem;">📋 Kriterien</h4>
            <p style="margin-bottom: 10px; color: #2c3e50; font-size: 0.98rem;">{{ selectedDogCategory.info.criteria }}</p>
          </div>
          <div style="background: linear-gradient(90deg, #f8ffae 0%, #43c6ac 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 12px 14px 8px 14px; margin-bottom: 12px;">
            <h4 style="color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 1rem;">⚖️ Gesetze</h4>
            <p style="margin-bottom: 10px; color: #2c3e50; font-size: 0.98rem;">{{ selectedDogCategory.info.laws }}</p>
          </div>
          <div style="background: linear-gradient(90deg, #fbc2eb 0%, #a6c1ee 100%); border-radius: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07); padding: 12px 14px 8px 14px;">
            <h4 style="color: #2c3e50; font-weight: 600; display: flex; align-items: center; gap: 6px; font-size: 1rem;">📑 Richtlinien</h4>
            <p style="color: #2c3e50; font-size: 0.98rem;">{{ selectedDogCategory.info.guidelines }}</p>
          </div>
        </div>
        <div *ngIf="!selectedDogCategory" style="color: #495057; font-size: 0.98rem; background: #e0eafc; border-radius: 8px; padding: 14px 12px; margin-top: 8px; box-shadow: 0 1px 4px rgba(80,120,200,0.07);">
          <h4 style="margin-top: 0; color: #2c3e50; font-weight: 600; font-size: 1rem;">Allgemeine Hinweise für Hundehalter</h4>
          <ul style="margin-bottom: 8px; padding-left: 18px;">
            <li>🐶 <b>Chip- und Registrierungspflicht:</b> Jeder Hund muss gechippt und bei der zuständigen Behörde gemeldet sein.</li>
            <li>🦴 <b>Haftpflichtversicherung:</b> Für viele Hunde ist eine Haftpflichtversicherung gesetzlich vorgeschrieben.</li>
            <li>🚦 <b>Leinen- und Maulkorbpflicht:</b> In öffentlichen Bereichen gelten je nach Region unterschiedliche Vorschriften.</li>
            <li>💡 <b>Verhalten:</b> Rücksichtnahme auf andere Menschen und Tiere ist Pflicht. Hundekot bitte immer entsorgen!</li>
            <li>⚠️ <b>Bußgelder:</b> Verstöße gegen die Vorschriften können zu hohen Strafen führen.</li>
          </ul>
          <div style="font-size: 0.95rem; color: #6c757d;">
            Weitere Infos findest du auf den offiziellen Seiten deiner Stadt oder Gemeinde, z.B. <a href="https://www.oesterreich.gv.at/themen/reisen_und_freizeit/haustiere.html" target="_blank" style="color: #3b6ea5; text-decoration: underline;">oesterreich.gv.at</a>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<!-- Modal für Standorttyp-Auswahl -->
<div *ngIf="showLocationTypeModal" class="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000;">
  <div class="modal-content" style="background: white; border-radius: 20px; padding: 32px; max-width: 500px; width: 90%; box-shadow: 0 12px 48px rgba(0,0,0,0.4); text-align: center;">
    <h2 style="margin: 0 0 24px 0; color: #2c3e50; font-size: 1.4rem;">Was möchten Sie hinzufügen?</h2>
    
    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 24px;">
      <!-- Hundepark Option -->
      <button 
        (click)="selectLocationType('park')"
        style="background: linear-gradient(135deg, #28a745, #20c997); color: white; border: none; border-radius: 16px; padding: 24px 16px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 16px rgba(40, 167, 69, 0.3); display: flex; flex-direction: column; align-items: center; gap: 12px; font-size: 14px; font-weight: 600;"
        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(40, 167, 69, 0.4)'"
        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 16px rgba(40, 167, 69, 0.3)'"
      >
        <div style="font-size: 2.5rem;">🏞️</div>
        <div>Hundepark</div>
        <div style="font-size: 0.85rem; opacity: 0.9; font-weight: 400;">Eingezäunter Bereich für Hunde</div>
      </button>

      <!-- Hundesackerlspender Option -->
      <button 
        (click)="selectLocationType('dispenser')"
        style="background: linear-gradient(135deg, #ffc107, #fd7e14); color: white; border: none; border-radius: 16px; padding: 24px 16px; cursor: pointer; transition: all 0.3s ease; box-shadow: 0 4px 16px rgba(255, 193, 7, 0.3); display: flex; flex-direction: column; align-items: center; gap: 12px; font-size: 14px; font-weight: 600;"
        onmouseover="this.style.transform='translateY(-2px)'; this.style.boxShadow='0 6px 20px rgba(255, 193, 7, 0.4)'"
        onmouseout="this.style.transform='translateY(0)'; this.style.boxShadow='0 4px 16px rgba(255, 193, 7, 0.3)'"
      >
        <div style="font-size: 2.5rem;">🗑️</div>
        <div>Hundesackerlspender</div>
        <div style="font-size: 0.85rem; opacity: 0.9; font-weight: 400;">Spender für Hundekotbeutel</div>
      </button>
    </div>

    <!-- Abbrechen Button -->
    <button 
      (click)="cancelTypeSelection()" 
      style="padding: 12px 24px; border: 2px solid #6c757d; background: white; color: #6c757d; border-radius: 10px; font-weight: 600; cursor: pointer; transition: all 0.2s; min-width: 120px;"
      onmouseover="this.style.background='#6c757d'; this.style.color='white'"
      onmouseout="this.style.background='white'; this.style.color='#6c757d'"
    >
      Abbrechen
    </button>
  </div>
</div>

<!-- Modal für neue Standorte -->
<div *ngIf="showAddLocationModal" class="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000;">
  <div class="modal-content" style="background: white; border-radius: 16px; padding: 24px; max-width: 500px; width: 90%; max-height: 80vh; overflow-y: auto; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
    <h2 style="margin: 0 0 20px 0; color: #2c3e50; text-align: center;">
      {{ newLocationType === 'park' ? '🏞️ Neuen Hundepark hinzufügen' : '🗑️ Neuen Hundesackerlspender hinzufügen' }}
    </h2>
    
    <form (ngSubmit)="saveNewLocation()" style="display: flex; flex-direction: column; gap: 16px;">
      <!-- Name -->
      <div>
        <label style="display: block; margin-bottom: 4px; font-weight: 600; color: #2c3e50;">Name *</label>
        <input 
          type="text" 
          [(ngModel)]="newLocationForm.name" 
          name="name"
          required
          style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
          [placeholder]="newLocationType === 'park' ? 'z.B. Hundepark Linz Zentrum' : 'z.B. Hundesackerlspender Hauptplatz'"
        >
      </div>

      <!-- Adresse -->
      <div>
        <label style="display: block; margin-bottom: 4px; font-weight: 600; color: #2c3e50;">Adresse *</label>
        <input 
          type="text" 
          [(ngModel)]="newLocationForm.address" 
          name="address"
          required
          style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
          placeholder="z.B. Hauptplatz 1, 4020 Linz"
        >
      </div>

      <!-- Sichtbarkeit -->
      <div style="display: flex; align-items: center; gap: 8px; padding: 12px; background: #f8f9fa; border-radius: 8px;">
        <input 
          type="checkbox" 
          [(ngModel)]="newLocationForm.isPublic" 
          name="isPublic"
          id="isPublic"
          style="transform: scale(1.2);"
        >
        <label for="isPublic" style="font-weight: 600; color: #2c3e50; cursor: pointer;">
          🌐 Öffentlich sichtbar (andere Nutzer können diesen Standort sehen)
        </label>
      </div>

      <!-- Park-spezifische Felder -->
      <div *ngIf="newLocationType === 'park'">
        <label style="display: block; margin-bottom: 4px; font-weight: 600; color: #2c3e50;">Ausstattung</label>
        <input 
          type="text" 
          [(ngModel)]="newLocationForm.facilities" 
          name="facilities"
          style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
          placeholder="z.B. Wasserspender, Agility-Parcours, Zaun (mit Komma trennen)"
        >
        
        <div style="display: flex; gap: 16px; margin-top: 12px;">
          <div style="flex: 1;">
            <label style="display: block; margin-bottom: 4px; font-weight: 600; color: #2c3e50;">Bewertung</label>
            <select 
              [(ngModel)]="newLocationForm.rating" 
              name="rating"
              style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
            >
              <option value="1">⭐ 1 Stern</option>
              <option value="2">⭐⭐ 2 Sterne</option>
              <option value="3">⭐⭐⭐ 3 Sterne</option>
              <option value="4">⭐⭐⭐⭐ 4 Sterne</option>
              <option value="5">⭐⭐⭐⭐⭐ 5 Sterne</option>
            </select>
          </div>
          
          <div style="display: flex; align-items: center; gap: 8px;">
            <input 
              type="checkbox" 
              [(ngModel)]="newLocationForm.isOpen" 
              name="isOpen"
              id="isOpen"
              style="transform: scale(1.2);"
            >
            <label for="isOpen" style="font-weight: 600; color: #2c3e50; cursor: pointer;">Geöffnet</label>
          </div>
        </div>
      </div>

      <!-- Spender-spezifische Felder -->
      <div *ngIf="newLocationType === 'dispenser'">
        <div style="display: flex; gap: 16px;">
          <div style="flex: 1;">
            <label style="display: block; margin-bottom: 4px; font-weight: 600; color: #2c3e50;">Typ</label>
            <select 
              [(ngModel)]="newLocationForm.type" 
              name="type"
              style="width: 100%; padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px;"
            >
              <option value="bags">🛍️ Nur Hundesackerl</option>
              <option value="bins">🗑️ Nur Mülleimer</option>
              <option value="both">🛍️🗑️ Sackerl + Mülleimer</option>
            </select>
          </div>
          
          <div style="display: flex; align-items: center; gap: 8px; margin-top: 24px;">
            <input 
              type="checkbox" 
              [(ngModel)]="newLocationForm.isWorking" 
              name="isWorking"
              id="isWorking"
              style="transform: scale(1.2);"
            >
            <label for="isWorking" style="font-weight: 600; color: #2c3e50; cursor: pointer;">Funktionsfähig</label>
          </div>
        </div>
      </div>

      <!-- Buttons -->
      <div style="display: flex; gap: 12px; margin-top: 20px;">
        <button 
          type="button" 
          (click)="closeModal()" 
          style="flex: 1; padding: 12px; border: 2px solid #6c757d; background: white; color: #6c757d; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
        >
          Abbrechen
        </button>
        <button 
          type="submit" 
          [disabled]="!newLocationForm.name || !newLocationForm.address"
          style="flex: 1; padding: 12px; border: none; background: linear-gradient(135deg, #28a745, #20c997); color: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
          [style.opacity]="(!newLocationForm.name || !newLocationForm.address) ? '0.5' : '1'"
          [style.cursor]="(!newLocationForm.name || !newLocationForm.address) ? 'not-allowed' : 'pointer'"
        >
          {{ newLocationType === 'park' ? 'Park hinzufügen' : 'Spender hinzufügen' }}
        </button>
      </div>
    </form>
  </div>
</div>

<!-- Modal für Status-Update -->
<div *ngIf="showStatusUpdateModal" class="modal-overlay" style="position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); display: flex; align-items: center; justify-content: center; z-index: 1000;">
  <div class="modal-content" style="background: white; border-radius: 16px; padding: 24px; max-width: 500px; width: 90%; box-shadow: 0 8px 32px rgba(0,0,0,0.3);">
    <h2 style="margin: 0 0 20px 0; color: #2c3e50; text-align: center;">
      <span *ngIf="selectedStationType === 'park'">🏞️ Hundepark-Status bearbeiten</span>
      <span *ngIf="selectedStationType === 'dispenser'">🗑️ Spender-Status bearbeiten</span>
    </h2>
    
    <div style="background: #f8f9fa; border-radius: 8px; padding: 16px; margin-bottom: 20px;">
      <h4 style="margin: 0 0 8px 0; color: #2c3e50; font-size: 1.1rem;">
        <span *ngIf="selectedStationType === 'park'">{{ getSelectedPark()?.name }}</span>
        <span *ngIf="selectedStationType === 'dispenser'">{{ getSelectedDispenser()?.name }}</span>
      </h4>
      <p style="margin: 0; color: #6c757d; font-size: 0.95rem;">
        <span *ngIf="selectedStationType === 'park'">{{ getSelectedPark()?.address }}</span>
        <span *ngIf="selectedStationType === 'dispenser'">{{ getSelectedDispenser()?.address }}</span>
      </p>
    </div>

    <!-- Status-Auswahl für Hundeparks -->
    <div *ngIf="selectedStationType === 'park'" style="margin-bottom: 20px;">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">Status ändern:</label>
      <div style="display: flex; flex-direction: column; gap: 12px;">
        <label style="display: flex; align-items: center; gap: 12px; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;" 
               [style.background]="statusUpdateForm.isOpen === true ? '#e3f2fd' : 'white'"
               [style.border-color]="statusUpdateForm.isOpen === true ? '#2196f3' : '#e9ecef'">
          <input type="radio" 
                 name="parkStatus" 
                 [value]="true" 
                 [(ngModel)]="statusUpdateForm.isOpen" 
                 style="transform: scale(1.2);">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="width: 12px; height: 12px; background-color: #28a745; border-radius: 50%; display: inline-block;"></span>
            <span style="font-weight: 600; color: #2c3e50;">Geöffnet</span>
          </div>
          <span style="color: #6c757d; font-size: 0.9rem; margin-left: auto;">Park ist zugänglich</span>
        </label>
        
        <label style="display: flex; align-items: center; gap: 12px; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;" 
               [style.background]="statusUpdateForm.isOpen === false ? '#ffebee' : 'white'"
               [style.border-color]="statusUpdateForm.isOpen === false ? '#f44336' : '#e9ecef'">
          <input type="radio" 
                 name="parkStatus" 
                 [value]="false" 
                 [(ngModel)]="statusUpdateForm.isOpen" 
                 style="transform: scale(1.2);">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="width: 12px; height: 12px; background-color: #dc3545; border-radius: 50%; display: inline-block;"></span>
            <span style="font-weight: 600; color: #2c3e50;">Geschlossen</span>
          </div>
          <span style="color: #6c757d; font-size: 0.9rem; margin-left: auto;">Park ist nicht zugänglich</span>
        </label>
      </div>
    </div>

    <!-- Status-Auswahl für Spender -->
    <div *ngIf="selectedStationType === 'dispenser'" style="margin-bottom: 20px;">
      <label style="display: block; margin-bottom: 8px; font-weight: 600; color: #2c3e50;">Status ändern:</label>
      <div style="display: flex; flex-direction: column; gap: 12px;">
        <label style="display: flex; align-items: center; gap: 12px; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;" 
               [style.background]="statusUpdateForm.isWorking === true ? '#fff3cd' : 'white'"
               [style.border-color]="statusUpdateForm.isWorking === true ? '#ffc107' : '#e9ecef'">
          <input type="radio" 
                 name="dispenserStatus" 
                 [value]="true" 
                 [(ngModel)]="statusUpdateForm.isWorking" 
                 style="transform: scale(1.2);">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="width: 12px; height: 12px; background-color: #ffc107; border-radius: 50%; display: inline-block;"></span>
            <span style="font-weight: 600; color: #2c3e50;">Funktionsfähig</span>
          </div>
          <span style="color: #6c757d; font-size: 0.9rem; margin-left: auto;">Spender funktioniert einwandfrei</span>
        </label>
        
        <label style="display: flex; align-items: center; gap: 12px; padding: 12px; border: 2px solid #e9ecef; border-radius: 8px; cursor: pointer; transition: all 0.2s;" 
               [style.background]="statusUpdateForm.isWorking === false ? '#ffebee' : 'white'"
               [style.border-color]="statusUpdateForm.isWorking === false ? '#f44336' : '#e9ecef'">
          <input type="radio" 
                 name="dispenserStatus" 
                 [value]="false" 
                 [(ngModel)]="statusUpdateForm.isWorking" 
                 style="transform: scale(1.2);">
          <div style="display: flex; align-items: center; gap: 8px;">
            <span style="width: 12px; height: 12px; background-color: #dc3545; border-radius: 50%; display: inline-block;"></span>
            <span style="font-weight: 600; color: #2c3e50;">Defekt</span>
          </div>
          <span style="color: #6c757d; font-size: 0.9rem; margin-left: auto;">Spender ist außer Betrieb</span>
        </label>
      </div>
    </div>

    <!-- Hinweis -->
    <div style="background: #e3f2fd; border-radius: 8px; padding: 12px; margin-bottom: 20px; border-left: 4px solid #2196f3;">
      <div style="display: flex; align-items: center; gap: 8px; margin-bottom: 4px;">
        <span style="font-size: 1.1rem;">ℹ️</span>
        <span style="font-weight: 600; color: #1976d2;">Hinweis</span>
      </div>
      <p style="margin: 0; color: #1976d2; font-size: 0.9rem;">
        Diese Änderung wird sofort für alle Nutzer sichtbar. Bitte stellen Sie sicher, dass die Angaben korrekt sind.
      </p>
    </div>

    <!-- Buttons -->
    <div style="display: flex; gap: 12px;">
      <button 
        type="button" 
        (click)="closeStatusUpdateModal()" 
        style="flex: 1; padding: 12px; border: 2px solid #6c757d; background: white; color: #6c757d; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
        onmouseover="this.style.background='#6c757d'; this.style.color='white'"
        onmouseout="this.style.background='white'; this.style.color='#6c757d'"
      >
        Abbrechen
      </button>
      <button 
        type="button" 
        (click)="saveStatusUpdate()" 
        [disabled]="!isStatusUpdateValid()"
        style="flex: 1; padding: 12px; border: none; background: linear-gradient(135deg, #28a745, #20c997); color: white; border-radius: 8px; font-weight: 600; cursor: pointer; transition: all 0.2s;"
        [style.opacity]="!isStatusUpdateValid() ? '0.5' : '1'"
        [style.cursor]="!isStatusUpdateValid() ? 'not-allowed' : 'pointer'"
        onmouseover="if(this.style.opacity !== '0.5') { this.style.transform='translateY(-1px)'; this.style.boxShadow='0 4px 12px rgba(40,167,69,0.3)'; }"
        onmouseout="if(this.style.opacity !== '0.5') { this.style.transform='translateY(0)'; this.style.boxShadow='none'; }"
      >
        Status aktualisieren
      </button>
    </div>
  </div>
</div>
